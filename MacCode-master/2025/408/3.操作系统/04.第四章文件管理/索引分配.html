<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <style>
        table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .important {
            background-color: #fff8e1;
        }
        .formula {
            font-family: monospace;
            background-color: #f9f9f9;
            padding: 5px;
            border-radius: 3px;
        }
    </style>
</head>
<body>

<h2>索引分配机制核心考点总结</h2>

<table>
    <tr>
        <th>分配方式</th>
        <th>结构示意图</th>
        <th>文件最大长度计算</th>
        <th>访问磁盘次数分析</th>
        <th>典型应用场景</th>
    </tr>
    <tr class="important">
        <td><strong>链接方案</strong></td>
        <td>索引块₁→索引块₂→...→索引块ₙ</td>
        <td>无固定上限（受磁盘容量限制）</td>
        <td>访问第i号索引块：i+1次（需顺序读取0~i-1号块）<br>访问数据块：i+2次</td>
        <td>小型文件或对随机访问要求低的场景</td>
    </tr>
    <tr class="important">
        <td><strong>K层索引</strong></td>
        <td>
            顶级索引→...→底层索引→数据块
            <div class="formula">（K层间接寻址）</div>
        </td>
        <td class="formula">
            (块大小/指针大小)^K × 块大小<br>
            例：4KB块+4B指针+K=3 → (1024)³×4KB=4GB
        </td>
        <td>
            访问任意数据块：K+1次<br>
            （K次读索引块 + 1次读数据块）<br>
            ★ 顶级索引在内存时：K次
        </td>
        <td>大文件存储（如数据库文件）</td>
    </tr>
    <tr class="important">
        <td><strong>混合索引</strong></td>
        <td>
            <div>直接指针 + 一级间接 + 二级间接 + ...</div>
            <div class="formula">（UNIX inode典型结构）</div>
        </td>
        <td>
            <div class="formula">
                N_direct×B + (B/P)×B + (B/P)²×B + ...
            </div>
            B=块大小，P=指针大小<br>
            例：12直接+1一级+1二级 →<br>
            12B + 1024B + 1024²B
        </td>
        <td>
            <ul>
                <li>直接块：1次（读数据）</li>
                <li>一级间接：2次（读索引+数据）</li>
                <li>二级间接：3次（两级索引+数据）</li>
                <li>★ FCB常驻内存</li>
            </ul>
        </td>
        <td>通用文件系统（如EXT4、NTFS）</td>
    </tr>
</table>

<h3>超级重要考点解析</h3>

<table>
    <tr>
        <th>考点类型</th>
        <th>解题关键</th>
        <th>典型例题</th>
    </tr>
    <tr>
        <td><strong>文件最大长度</strong></td>
        <td>
            1. 计算单块最大索引项：<span class="formula">n = floor(块大小/指针大小)</span><br>
            2. 层级计算：<span class="formula">总块数 = n^K（K层索引）</span><br>
            3. 混合索引分段求和
        </td>
        <td>
            <div>【408真题】设块大小1KB，指针4B，采用10个直接地址、1个一级间接、1个二级间接，求最大文件长度？</div>
            <div class="formula">
                解：n=1024/4=256<br>
                直接：10×1KB=10KB<br>
                一级：256×1KB=256KB<br>
                二级：256²×1KB=64MB<br>
                总和：10KB+256KB+64MB
            </div>
        </td>
    </tr>
    <tr>
        <td><strong>磁盘访问次数</strong></td>
        <td>
            1. 确认索引层级K<br>
            2. 检查FCB/顶级索引是否在内存<br>
            3. 访问路径：每级索引需1次读盘<br>
            4. 特别注意混合索引的不同区域
        </td>
        <td>
            <div>【模拟题】设三级索引，顶级索引在内存，访问某数据块需几次读盘？</div>
            <div class="formula">
                解：K=3 → 需访问2级索引块+数据块<br>
                共3次（内存中的顶级索引不计算）
            </div>
        </td>
    </tr>
</table>

<h3>408命题规律总结</h3>
<ol>
    <li>必考计算：文件最大长度（出现频率＞85%）</li>
    <li>高频考点：混合索引的磁盘访问次数（常与FCB状态结合）</li>
    <li>易错点：索引块计数包含自身（如二级索引实际占用3个磁盘块）</li>
    <li>核心公式：<span class="formula">n = B / P</span>（每块索引项数）</li>
</ol>

</body>
</html>